# Continuity ledger (per-branch)

## Human intent (must not be overwritten)

- Fix Biome warning `lint/performance/noImgElement` in Studio playground attachments without changing thumbnail behavior.

## Goal (incl. success criteria)

- Replace raw `<img>` with Next.js `Image` so `biome check` no longer reports `noImgElement` for `file-attachments.tsx`.

## Constraints/Assumptions

- Keep existing UX: show local preview while uploading, and when uploaded prefer server URL but fall back to local preview if server image fails.
- Keep changes minimal and localized.

## Key decisions

- Use a small `ImageThumbnail` component with internal `src` state to preserve the old “swap to fallback src on error” behavior.
- Use `Image` with `fill` inside the existing `60x60` relative container, and set `unoptimized` to support blob/object URLs safely.

## State

- `apps/studio.giselles.ai/app/(main)/playground/file-attachments.tsx` used a raw `<img>` for thumbnail previews.

## Done

- Switched thumbnail rendering to `next/image` and kept fallback behavior.
- Renamed `ImageThumbnail` props/callback to make remote→local fallback intent obvious (`remoteSrc`, `localFallbackSrc`, `onRemoteLoaded`) and documented why the callback fires only for remote loads.
- Reviewed `ImageThumbnail` implementation for edge cases (error fallback, cache, race conditions); overall looks solid with a couple minor tweaks worth considering.

## Now

- Need to run `pnpm biome check --write` on the modified file to confirm the warning is gone.

## Next

- None.

## Open questions (UNCONFIRMED if needed)

- None.

## Working set (files/ids/commands)

- `apps/studio.giselles.ai/app/(main)/playground/file-attachments.tsx`
- `pnpm biome check --write apps/studio.giselles.ai/app/(main)/playground/file-attachments.tsx`

